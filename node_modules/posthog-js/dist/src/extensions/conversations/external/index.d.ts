import { ConversationsRemoteConfig } from '../../../posthog-conversations-types';
import { PostHog } from '../../../posthog-core';
import { ConversationsManager as ConversationsManagerInterface } from '../posthog-conversations';
export declare class ConversationsManager implements ConversationsManagerInterface {
    private readonly _posthog;
    private _config;
    private _persistence;
    private _widgetRef;
    private _containerElement;
    private _currentTicketId;
    private _pollIntervalId;
    private _lastMessageTimestamp;
    private _isPolling;
    private _unsubscribeIdentifyListener;
    private _unreadCount;
    private _widgetSessionId;
    constructor(config: ConversationsRemoteConfig, _posthog: PostHog);
    /** Send a message via the API */
    private _apiSendMessage;
    /** Fetch messages via the API */
    private _apiGetMessages;
    /** Mark messages as read via the API */
    private _apiMarkAsRead;
    /**
     * Initialize the widget
     */
    private _initialize;
    /**
     * Get initial user traits from PostHog or localStorage
     */
    private _getInitialUserTraits;
    /**
     * Handle user identification from the widget form
     */
    private _handleIdentify;
    /**
     * Handle sending a message
     */
    private _handleSendMessage;
    /**
     * Handle widget state changes
     */
    private _handleStateChange;
    /**
     * Mark messages as read
     */
    private _markMessagesAsRead;
    /**
     * Load messages for the current ticket
     */
    private _loadMessages;
    /**
     * Check if the widget is currently open
     */
    private _isWidgetOpen;
    /**
     * Poll for new messages
     */
    private _pollMessages;
    /**
     * Start polling for new messages
     */
    private _startPolling;
    /**
     * Stop polling for new messages
     */
    private _stopPolling;
    /**
     * Setup listener for identify events to handle distinct_id changes
     */
    private _setupIdentifyListener;
    /**
     * Handle distinct_id changes when user identifies.
     * The user continues their conversation seamlessly - widget_session_id stays the same.
     * No migration needed since tickets are keyed by widget_session_id, not distinct_id.
     * Backend will update ticket.distinct_id for Person linking on the next message.
     */
    private _handleDistinctIdChange;
    /**
     * Enable/show the widget (button and chat panel)
     */
    enable(): void;
    /**
     * Disable/hide the widget completely (button and chat panel)
     */
    disable(): void;
    /**
     * Send a message programmatically (internal use)
     */
    sendMessage(message: string): void;
    /**
     * Clean up the widget
     */
    destroy(): void;
    /**
     * Reset all conversation data and destroy the widget.
     * Called on posthog.reset() to start fresh.
     */
    reset(): void;
    /**
     * Render the widget to the DOM
     */
    private _renderWidget;
}
/**
 * Initialize the conversations widget
 * This is the entry point called from the lazy-loaded bundle
 */
export declare function initConversations(config: ConversationsRemoteConfig, posthog: PostHog): ConversationsManager;
